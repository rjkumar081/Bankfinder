<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bank Finder</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f4f7f9;
    }
    header {
      background: #005f99;
      color: #fff;
      padding: 15px;
      text-align: center;
      font-size: 1.6em;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .tab-container {
      display: flex;
      justify-content: center;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .tab {
      flex: 1;
      min-width: 150px;
      padding: 12px;
      background: #e0e0e0;
      text-align: center;
      cursor: pointer;
      transition: background 0.3s;
      border: 1px solid #ccc;
    }
    .tab.active {
      background: #0078d7;
      color: white;
      font-weight: bold;
    }
    .tab-content {
      display: none;
      padding: 20px;
      max-width: 700px;
      margin: auto;
    }
    .tab-content.active {
      display: block;
    }
    label {
      display: block;
      margin: 12px 0 5px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 10px;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .result-card {
      background: #fff;
      margin-top: 15px;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    footer {
      background: #005f99;
      color: #fff;
      padding: 12px;
      text-align: center;
      font-weight: bold;
      position: relative;
      margin-top: 40px;
    }
  </style>
</head>
<body>

<header>üí≥ Bank IFSC Finder - Get Bank Details in One Click</header>

<div class="tab-container">
  <div class="tab active" onclick="switchTab(1)">üîç Find Bank by IFSC</div>
  <div class="tab" onclick="switchTab(2)">üè¶ Find IFSC by Bank Details</div>
</div>

<!-- Tab 1 -->
<div class="tab-content active" id="tab1">
  <div style="max-width: 600px; margin: auto;">
    <label>Enter IFSC Code</label>
    <input type="text" id="ifscInput" placeholder="e.g., SBIN0005573" oninput="fetchIFSCDetails()" />
    <div id="resultBox1"></div>
  </div>
</div>

<!-- Tab 2 -->
<div class="tab-content" id="tab2">
  <div style="max-width: 600px; margin: auto;">
    <label>Bank</label>
    <select id="bankSelect" onchange="populateStates()"></select>

    <label>State</label>
    <select id="stateSelect" onchange="populateCities()"></select>

    <label>City</label>
    <select id="citySelect" onchange="populateBranches()"></select>

    <label>Branch</label>
    <select id="branchSelect" onchange="displayIFSC()"></select>

    <div id="resultBox2" class="result-card"></div>
  </div>
</div>

<footer>üîó Designed by Raj</footer>

<script>
  let bankData = [];

  function switchTab(tabNum) {
    document.querySelectorAll('.tab').forEach((el, i) => {
      el.classList.toggle('active', i + 1 === tabNum);
    });
    document.querySelectorAll('.tab-content').forEach((el, i) => {
      el.classList.toggle('active', i + 1 === tabNum);
    });
  }

  // Tab 1: Live IFSC Fetch
  async function fetchIFSCDetails() {
    const ifsc = document.getElementById('ifscInput').value.trim().toUpperCase();
    const resultBox = document.getElementById('resultBox1');

    if (ifsc.length < 5) {
      resultBox.innerHTML = '';
      return;
    }

    try {
      const res = await fetch(`https://ifsc.razorpay.com/${ifsc}`);
      if (!res.ok) throw new Error('Invalid IFSC');
      const data = await res.json();

      resultBox.innerHTML = `
        <div class="result-card">
          <h3>${data.BANK} - ${data.BRANCH}</h3>
          <p><strong>IFSC:</strong> ${data.IFSC}</p>
          <p><strong>Address:</strong> ${data.ADDRESS}</p>
          <p><strong>City:</strong> ${data.CITY}</p>
          <p><strong>District:</strong> ${data.DISTRICT}</p>
          <p><strong>State:</strong> ${data.STATE}</p>
          <p><strong>MICR:</strong> ${data.MICR || 'N/A'}</p>
          <p><strong>UPI:</strong> ${data.UPI ? 'Available' : 'Not Available'}</p>
          <p><strong>NEFT:</strong> ${data.NEFT ? 'Available' : 'Not Available'}</p>
          <p><strong>RTGS:</strong> ${data.RTGS ? 'Available' : 'Not Available'}</p>
          <p><strong>IMPS:</strong> ${data.IMPS ? 'Available' : 'Not Available'}</p>
        </div>
      `;
    } catch {
      resultBox.innerHTML = '<div class="result-card">‚ùå Invalid IFSC Code or Not Found.</div>';
    }
  }

  // Tab 2: Offline data
  async function loadBankData() {
    try {
      const res = await fetch('bankdata.json');
      bankData = await res.json();

      const banks = [...new Set(bankData.map(b => b.BANK))].sort();
      const bankSelect = document.getElementById('bankSelect');
      banks.forEach(b => {
        const opt = document.createElement('option');
        opt.value = b;
        opt.textContent = b;
        bankSelect.appendChild(opt);
      });
    } catch (err) {
      alert('Failed to load local bank data.');
    }
  }

  function populateStates() {
    const bank = document.getElementById('bankSelect').value;
    const states = [...new Set(bankData.filter(b => b.BANK === bank).map(b => b.STATE))].sort();
    const stateSelect = document.getElementById('stateSelect');
    stateSelect.innerHTML = '<option value="">Select State</option>';
    states.forEach(s => {
      const opt = document.createElement('option');
      opt.value = s;
      opt.textContent = s;
      stateSelect.appendChild(opt);
    });

    document.getElementById('citySelect').innerHTML = '';
    document.getElementById('branchSelect').innerHTML = '';
    document.getElementById('resultBox2').innerHTML = '';
  }

  function populateCities() {
    const bank = document.getElementById('bankSelect').value;
    const state = document.getElementById('stateSelect').value;
    const cities = [...new Set(bankData.filter(b => b.BANK === bank && b.STATE === state).map(b => b.CITY))].sort();
    const citySelect = document.getElementById('citySelect');
    citySelect.innerHTML = '<option value="">Select City</option>';
    cities.forEach(c => {
      const opt = document.createElement('option');
      opt.value = c;
      opt.textContent = c;
      citySelect.appendChild(opt);
    });

    document.getElementById('branchSelect').innerHTML = '';
    document.getElementById('resultBox2').innerHTML = '';
  }

  function populateBranches() {
    const bank = document.getElementById('bankSelect').value;
    const state = document.getElementById('stateSelect').value;
    const city = document.getElementById('citySelect').value;
    const branches = bankData.filter(b => b.BANK === bank && b.STATE === state && b.CITY === city);
    const branchSelect = document.getElementById('branchSelect');
    branchSelect.innerHTML = '<option value="">Select Branch</option>';
    branches.forEach(b => {
      const opt = document.createElement('option');
      opt.value = b.BRANCH;
      opt.textContent = b.BRANCH;
      branchSelect.appendChild(opt);
    });

    document.getElementById('resultBox2').innerHTML = '';
  }

  function displayIFSC() {
    const bank = document.getElementById('bankSelect').value;
    const state = document.getElementById('stateSelect').value;
    const city = document.getElementById('citySelect').value;
    const branch = document.getElementById('branchSelect').value;
    const match = bankData.find(b => b.BANK === bank && b.STATE === state && b.CITY === city && b.BRANCH === branch);

    if (match) {
      document.getElementById('resultBox2').innerHTML = `
        <p><strong>IFSC:</strong> ${match.IFSC}</p>
        <p><strong>Address:</strong> ${match.ADDRESS}</p>
        <p><strong>District:</strong> ${match.DISTRICT}</p>
        <p><strong>MICR:</strong> ${match.MICR || 'N/A'}</p>
      `;
    } else {
      document.getElementById('resultBox2').innerHTML = '<p>No data found.</p>';
    }
  }

  window.onload = loadBankData;
</script>
</body>
</html>
